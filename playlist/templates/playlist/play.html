<html>
    <head>
        <script
            src="https://code.jquery.com/jquery-3.2.1.min.js"
            integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
            crossorigin="anonymous">
            
        </script>
        <title>GO PLAYER - PLAY</title>
    </head>
    <body>
        <div id="player"></div>
	<hr/>
	<small>Patryk Kurzeja | p.kurzeja@go.pl | 2017</small>


    <script>
      var tag = document.createElement('script');

      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      var player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height: '360',
          width: '640',
          videoId: '{{ video_id }}',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });
      }

      function onPlayerReady(event) {
        event.target.playVideo();
      }

      function onPlayerStateChange(event) {
        console.log('video change state: ' + event.data);
        if (event.data == YT.PlayerState.ENDED){
            location.reload();
            console.log('video ended');
        }
      }
      function stopVideo() {
        player.stopVideo();
      }
    </script>
    </body>
</html>
